# Быстрое развертывание FastenersAI V2

## Проблема
Сейчас работает старая версия бота, которая генерирует только одну таблицу вместо 4 вкладок по спецификации.

## Решение

### 1. Обновите Railway

Сделайте коммит и пуш изменений:

```bash
git add .
git commit -m "Deploy FastenersAI V2 with multi-sheet Excel"
git push origin main
```

### 2. Загрузите тестовые данные в Supabase

Выполните скрипт загрузки данных:

```bash
python load_sample_data.py
```

### 3. Проверьте развертывание

После деплоя проверьте:

1. **Статус бота**: `/status` - должен показать "Enhanced Architecture"
2. **Версия**: `/version` - должен показать "v2"
3. **Тест**: Отправьте сообщение "Болт DIN 933 кл.пр.8.8 М10х30, цинк"

### 4. Ожидаемый результат

Новый бот должен генерировать Excel файл с **4 вкладками**:

1. **Итог** - финальные результаты с выбранными KU
2. **Кандидаты** - все найденные варианты с оценками
3. **Вход** - исходные данные
4. **Ошибки** - строки, которые не удалось обработать

## Что изменилось

### Procfile
```
web: uvicorn webhook_app_v2:app --host 0.0.0.0 --port $PORT
```

### Новые файлы
- `webhook_app_v2.py` - новое приложение
- `pipeline/` - обработка текста и сопоставление
- `services/excel_generator_v2.py` - генерация 4 вкладок
- `database/supabase_client_v2.py` - работа с новой схемой

### Обновленные файлы
- `requirements.txt` - новые зависимости
- `Procfile` - новое приложение

## Если что-то не работает

1. **Проверьте логи Railway** - должны быть сообщения о загрузке V2
2. **Проверьте базу данных** - должны быть таблицы items и sku_aliases
3. **Проверьте переменные окружения** - SUPABASE_URL, SUPABASE_KEY, OPENAI_API_KEY

## Тестовые данные

После загрузки в базе будут:
- 4 товара (болты и анкеры)
- 8 алиасов для поиска
- Готовые тестовые данные

## Результат

После успешного развертывания бот будет:
- ✅ Обрабатывать текст с нормализацией
- ✅ Находить кандидатов с оценками
- ✅ Использовать GPT для неопределенных случаев
- ✅ Генерировать Excel с 4 вкладками
- ✅ Показывать детальную информацию о процессе
